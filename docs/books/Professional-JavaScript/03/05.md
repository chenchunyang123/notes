---
title: '操作符'
---

## 一元操作符

定义：只能操作一个值的操作符。

#### 1、递增递减操作符

分为<b>前置型</b>和<b>后置型</b>，区别在于执行前置递增和递减操作时，变量的值都是在语句被求值以前改变的。
```js
var age = 29; 
var anotherAge = --age + 2; 
alert(age); // 输出 28 
alert(anotherAge); // 输出 30
```
并且前置递增和递减操作与执行语句的优先级相等：
```js
var num1 = 2; 
var num2 = 20; 
var num3 = --num1 + num2; // 等于 21 
var num4 = num1 + num2; // 等于 21
```
如果改为后置：
```js
var num1 = 2; 
var num2 = 20; 
var num3 = num1-- + num2; // 等于 22 
var num4 = num1 + num2; // 等于 21
```

它们不仅适用于整数，还可以用于字符串、布尔值、浮点数值和对象，转换的时候有以下规则：
- 在应用于一个包含有效数字字符的字符串时，先将其转换为数字值，再执行加减 1 的操作。
- 在应用于一个不包含有效数字字符的字符串时，将变量的值设置为 NaN。
- 在应用于布尔值 false 时，先将其转换为 0 再执行加减 1 的操作。
- 在应用于布尔值 true 时，先将其转换为 1 再执行加减 1 的操作。
- 在应用于浮点数值时，执行加减 1 的操作。
- 在应用于对象时，先调用对象的 valueOf()方法以取得一个可供操作的值。然后对该值应用前述规则。如果结果是 NaN，则在调用 toString()方法后再应用前述规则。

转换完过后，变量都会转换为数值类型的变量。

例：
```js
var s1 = "2"; 
var s2 = "z"; 
var b = false; 
var f = 1.1; 
var o = { 
 valueOf: function() { 
 return -1; 
 } 
}; 
s1++; // 值变成数值 3 
s2++; // 值变成 NaN 
b++; // 值变成数值 1 
f--; // 值变成 0.10000000000000009（由于浮点舍入错误所致）
o--; // 值变成数值-2
```

#### 2、一元加和减操作符

- 一元加：
  - 放数值前没影响，对非数值应用会让值进行Number()转换
  - 布尔值 false 和 true 将被转换为 0 和 1
  - 字符串值会被按照一组[特殊的规则](./04.html#数值转换)进行解析
  - 对象是先调用它们的 valueOf()和（或）toString()方法，再转换得到的值
  ```js
  var s1 = "01"; 
  var s2 = "1.1"; 
  var s3 = "z"; 
  var b = false; 
  var f = 1.1; 
  var o = { 
    valueOf: function() { 
      return -1; 
    } 
  }; 
  s1 = +s1; // 值变成数值 1 
  s2 = +s2; // 值变成数值 1.1 
  s3 = +s3; // 值变成 NaN 
  b = +b; // 值变成数值 0 
  f = +f; // 值未变，仍然是 1.1 
  o = +o; // 值变成数值-1
  ```

- 一元减：

一元减操作主要用作表示负数，对于数值应用，该值会变为负数；对于非数值，遵循一元加相同的规则，然后再将值变为负数。
```js
var s1 = "01"; 
var s2 = "1.1"; 
var s3 = "z"; 
var b = false; 
var f = 1.1; 
var o = { 
 valueOf: function() { 
  return -1; 
 } 
}; 
s1 = -s1; // 值变成了数值-1 
s2 = -s2; // 值变成了数值-1.1 
s3 = -s3; // 值变成了 NaN 
b = -b; // 值变成了数值 0 
f = -f; // 变成了-1.1 
o = -o; // 值变成了数值 1
```


## 位操作符

按内存中表示数值的位来操作数值。

对于有符号的整数，32 位中的前 31 位用于表示整数的值。 32 位用于表示数值的符号：0 表示正数，1 表示负数。这个表示符号的位叫做符号位。其中，二进制数最右边的数的位置称为位0，最左边的称为位31。

- 正数以纯二进制格式存储，31 位中的每一位都表示 2 的幂。如：18的二进制表示为00000000000000000000000000010010，或者更简洁的 10010，即2^4\*1 + 2^3\*0 + 2^2\*0 + 2^1\*1 + 2^0\*0 = 18。

- 负数储存的格式是二进制补码：

  1. 求这个数值绝对值的二进制码;
  2. 求二进制反码，即将 0 替换为 1，将 1 替换为 0；
  3. 得到的二进制反码加 1。
  ```js
  // 如-18的二进制码
  // 1.先得到18的二进制码
  0000 0000 0000 0000 0000 0000 0001 0010
  // 2.求其二进制反码，即 0 和 1 互换
  1111 1111 1111 1111 1111 1111 1110 1101
  // 3.二进制反码加 1
  1111 1111 1111 1111 1111 1111 1110 1110
  ```
  但是ECMAScript 会尽力向我们隐藏所有这些信息，在以二进制字符串形式输出一个负数时，我们看到的只是这个负数绝对值的二进制码前面加上了一个负号：
  ```js
  var num = -18; 
  alert(num.toString(2)); // "-10010"
  ```

注：在对特殊的 NaN 和 Infinity 值应用位操作时，这两个值都会被当成 0 来处理；对非数值应用位操作符，会先使用 Number()函数将该值转换为一个数值（自动完成）。

#### 1、按位非

由一个波浪线（~）表示，结果是返回数值的反码。计算的本质其实就是操作数的负值减 1，由于按位非是在数值表示的最底层执行操作，因此速度比手动算负值再减一快。
```js
var num1 = 25; // 二进制 00000000000000000000000000011001 
var num2 = ~num1; // 二进制 11111111111111111111111111100110 
alert(num2); // -26
```

#### 2、按位与

由一个和号字符（&）表示，有两个操作数。本质上就是将两个数值的每一位都对齐，然后根据下表的规则，对相同位置上的两个数执行操作。

|第一个数值的位|第二个数值的位|结果|
|-|-|-|
|1|1|1|
|1|0|0|
|0|1|0|
|0|0|0|

```js
var result = 25 & 3; 
alert(result); //1

// 底层操作如下

 25 = 0000 0000 0000 0000 0000 0000 0001 1001 
  3 = 0000 0000 0000 0000 0000 0000 0000 0011 
--------------------------------------------- 
AND = 0000 0000 0000 0000 0000 0000 0000 0001
```

#### 3、按位或

由一个竖线符号（|）表示，有两个操作数。操作与按位与类似，只是对应的规则不太一样。

|第一个数值的位|第二个数值的位|结果|
|-|-|-|
|1|1|1|
|1|0|1|
|0|1|1|
|0|0|0|

```js
var result = 25 | 3; 
alert(result); //27

// 底层操作如下

25 = 0000 0000 0000 0000 0000 0000 0001 1001 
 3 = 0000 0000 0000 0000 0000 0000 0000 0011 
-------------------------------------------- 
OR = 0000 0000 0000 0000 0000 0000 0001 1011
```

#### 4、按位异或

由一个插入符号（^）表示，也有两个操作数。下面是它的真值表规则。

|第一个数值的位|第二个数值的位|结果|
|-|-|-|
|1|1|0|
|1|0|1|
|0|1|1|
|0|0|0|

```js
var result = 25 ^ 3; 
alert(result); //26

// 底层操作如下

  25 = 0000 0000 0000 0000 0000 0000 0001 1001 
   3 = 0000 0000 0000 0000 0000 0000 0000 0011 
 --------------------------------------------- 
 XOR = 0000 0000 0000 0000 0000 0000 0001 1010
```

#### 5、左移

由两个小于号（<<）表示，这个操作符会将数值的所有位向左移动指定的位数。

```js
var oldValue = 2; // 等于二进制的 10 
var newValue = oldValue << 5; // 等于二进制的 1000000，十进制的 64
```

注意：左移不会影响操作数的符号位，例如将-2 向左移动 5 位，结果是-64，而非 64。

#### 6、有符号右移

由两个大于号（>>）表示，这个操作符会将数值向右移动，但保留符号位（即正负号标记）。

有符号的右移操作与左移操作恰好相反：
```js
var oldValue = 64; // 等于二进制的 1000000 
var newValue = oldValue >> 5; // 等于二进制的 10 ，即十进制的 2
```
在移位过程中，原数值中也会出现空位。只不过空位出现在原数值的左侧、符号位(位31)的右侧。而此时 ECMAScript 会用符号位的值来填充所有空位，以便得到一个完整的值。

#### 7、无符号右移

由 3 个大于号（>>>）表示，这个操作符会将数值的所有 32 位都向右移动。并且是以0来填充空位，不像有符号的以符号位填充。

对正数来说，无符号右移的结果与有符号右移相同:
```js
var oldValue = 64; // 等于二进制的 1000000 
var newValue = oldValue >>> 5; // 等于二进制的 10 ，即十进制的 2
```
但是对负数来说：
```js
var oldValue = -64; // 等于二进制的 11111111111111111111111111000000 
var newValue = oldValue >>> 5; // 等于十进制的 134217726
```
因为无符号右移操作会把 <b>11111111111111111111111111000000</b> 这个二进制码当成正数的二进制码，换算成十进制就是 <b>4294967232</b>，然后再位移5位就是 <b>00000111111111111111111111111110</b>，即十进制的 <b>134217726</b>。

## 布尔操作符

有非（NOT）、与（AND）和或（OR）。

#### 1、非

由一个感叹号表示，可以用于任何值。

规则：
|值|返回值|
|-|-|
|对象|false|
|空字符串|true|
|非空字符串|false|
|0|true|
|任意非 0 数值（包括 Infinity）|false|
|null|true|
|NaN|true|
|undefined|true|

例：
```js
alert(!false); // true 
alert(!"blue"); // false 
alert(!0); // true 
alert(!NaN); // true 
alert(!""); // true 
alert(!12345); // false
```

注：如果连续两次取反，实际上就会模拟 Boolean()转型函数的行为。
```js
alert(!!"blue"); //true 
alert(!!0); //false 
alert(!!NaN); //false 
alert(!!""); //false 
alert(!!12345); //true
```

#### 2、与

由两个和号表示（&&）、有两个操作数。

两个操作数都为true，结果才是true；一个为false，则结果为false。所以在执行时遇到false，就返回。

逻辑与操作属于<b>短路操作</b>，如果第一个操作数能够决定结果，那么就不会再对第二个操作数求值。

例：
```js
var found = true; 
var result = (found && someUndefinedVariable); // 这里会发生错误,会走到第二个未定义的操作数
alert(result); // 这一行不会执行
```
```js
var found = false; 
var result = (found && someUndefinedVariable); // 不会发生错误，走到第一个操作数是false后，就停止了
alert(result); // 会执行（"false"）
```

#### 3、或

由两个竖线符号（||）表示，有两个操作数。

两个操作数其中一个为true，则为true；都为false，才是false。所以在执行时遇到true，就返回。

跟逻辑与类似，也是短路操作。

例：
```js
var found = true; 
var result = (found || someUndefinedVariable); // 不会发生错误
alert(result); // 会执行（"true"）
```
```js
var found = false; 
var result = (found || someUndefinedVariable); // 这里会发生错误
alert(result); // 这一行不会执行
```

## 乘性操作符

有乘法、除法和求模。

#### 1、乘法

由一个星号（*）表示，用于计算两个数的乘积。

规则：
- 如果操作数都是数值，执行常规的乘法计算，如果结果超过ECMAScript 数值的表示范围，则返回 Infinity 或-Infinity；
- 如果有一个操作数是 NaN，则返回 NaN；
- 如果是 Infinity 与 0 相乘，则返回 NaN；
- 如果是 Infinity 与非 0 数值相乘，则结果是 Infinity 或-Infinity，取决于有符号操作数的符号；
- 如果是 Infinity 与 Infinity 相乘，则结果是 Infinity；
- 如果有一个操作数不是数值，则在后台调用 Number()将其转换为数值，然后再应用上面的规则。

#### 2、除法

由一个斜线符号（/）表示，执行第二个操作数除第一个操作数的计算。

规则：
- 如果操作数都是数值，执行常规的除法计算；
- 如果有一个操作数是 NaN，则结果是 NaN；
- 如果是 Infinity 被 Infinity 除，则结果是 NaN；
- 如果是零被零除，则结果是 NaN；
- 如果是非零的有限数被零除，则结果是 Infinity 或-Infinity，取决于有符号操作数的符号；
- 如果是 Infinity 被任何非零数值除，则结果是 Infinity 或-Infinity，取决于有符号操作数的符号；
- 如果有一个操作数不是数值，则在后台调用 Number()将其转换为数值，然后再应用上面的规则。

#### 3、求模

求模（余数）操作符由一个百分号（%）表示。

规则：
- 如果操作数都是数值，执行常规的除法计算，返回除得的余数；
- 如果被除数是无穷大值而除数是有限大的数值，则结果是 NaN；
- 如果被除数是有限大的数值而除数是零，则结果是 NaN；
- 如果是 Infinity 被 Infinity 除，则结果是 NaN；
- 如果被除数是有限大的数值而除数是无穷大的数值，则结果是被除数；
- 如果被除数是零，则结果是零；
- 如果有一个操作数不是数值，则在后台调用 Number()将其转换为数值，然后再应用上面的规则。

## 加性操作符

有加法和减法。

#### 1、加法

- 两个操作符都是数值
  - 如果有一个操作数是 NaN，则结果是 NaN；
  - 如果是 Infinity 加 Infinity，则结果是 Infinity；
  - 如果是-Infinity 加-Infinity，则结果是-Infinity；
  - 如果是 Infinity 加-Infinity，则结果是 NaN；
  - 如果是+0 加+0，则结果是+0；
  - 如果是-0 加-0，则结果是-0；
  - 如果是+0 加0，则结果是+0。
- 有操作数是字符串
  - 如果两个操作数都是字符串，则将第二个操作数与第一个操作数拼接起来；
  - 如果只有一个操作数是字符串，则将另一个操作数转换为字符串，然后再将两个字符串拼接起来。
- 有操作数是对象、数值或布尔值
  - 调用它们的 toString()方法取得相应的字符串值，然后再应用前面关于字符串的规则。对于 undefined 和 null，则分别调用 String()函数并取得字符串"undefined"和"null"。

#### 2、减法

- 两个操作符都是数值
  - 如果有一个操作数是 NaN，则结果是 NaN；
  - 如果是 Infinity 减 Infinity，则结果是 NaN；
  - 如果是-Infinity 减-Infinity，则结果是 NaN；
  - 如果是 Infinity 减-Infinity，则结果是 Infinity；
  - 如果是-Infinity 减 Infinity，则结果是-Infinity；
  - 如果是+0 减+0，则结果是+0；
  - 如果是+0 减-0，则结果是-0；
  - 如果是-0 减-0，则结果是+0；
- 有操作数是字符串、布尔值、null 或 undefined
  - 先在后台调用 Number()函数将其转换为数值，然后再根据前面的规则执行减法计算。如果转换的结果是 NaN，则减法的结果就是 NaN；
- 有操作数是对象
  - 调用对象的 valueOf()方法以取得表示该对象的数值。如果得到的值是 NaN，则减法的结果就是 NaN。如果对象没有 valueOf()方法，则调用其 toString()方法并将得到的字符串转换为数值。

## 关系操作符

有小于（<）、大于（>）、小于等于（<=）和大于等于（>=）。

```js
var result1 = 5 > 3; //true 
var result2 = 5 < 3; //false
```

规则：
- 两个操作数都是数值，则执行数值比较。
- 两个操作数都是字符串，则比较两个字符串对应的字符编码值。
- 一个操作数是数值，则将另一个操作数转换为一个数值，然后执行数值比较。
- 一个操作数是对象，则调用这个对象的 valueOf()方法，用得到的结果按照前面的规则执行比较。如果对象没有 valueOf()方法，则调用 toString()方法，并用得到的结果根据前面的规则执行比较。
- 如果一个操作数是布尔值，则先将其转换为数值，然后再执行比较。

```js
var result = "Brick" < "alphabet"; //true，字母 B 的字符编码为 66，字母 a 的字符编码是 97
```

一个奇怪的例子：
```js
var result1 = "a" < 3; //false 
var result2 = "a" >= 3; //false
// “a”会被转换为NaN，NaN与任何数比较都返回false
```

## 相等操作符

两组操作符：<b>相等和不相等</b>——<b>先转换再比较</b>，<b>全等和不全等</b>——<b>仅比较而不转换</b>。

#### 1、相等和不相等

相等由两个等号表示（==），如果两个操作数相等，则返回 true；

不相等操作符由叹号后跟等于号（!=）表示，如果两个操作数不相等，则返回 true。

这两个操作符都会先转换操作数（通常称为强制转型），然后再比较它们的相等性。

转换规则：
- 如果有一个操作数是布尔值，则在比较相等性之前先将其转换为数值——false 转换为 0，而true 转换为 1；
- 如果一个操作数是字符串，另一个操作数是数值，在比较相等性之前先将字符串转换为数值；
- 如果一个操作数是对象，另一个操作数不是，则调用对象的 valueOf()方法，用得到的基本类型值按照前面的规则进行比较；

比较规则：
- null 和 undefined 是相等的。
- 要比较相等性之前，不能将 null 和 undefined 转换成其他任何值。
- 如果有一个操作数是 NaN，则相等操作符返回 false，而不相等操作符返回 true。
- 如果两个操作数都是对象，并且都指向同一个对象，则相等操作符返回 true。

一些特殊情况及结果：
|表达式|值|
|-|-|
|null == undefined|true|
|"NaN" == NaN|false|
|5 == NaN|false|
|NaN == NaN|false|
|NaN != NaN|true|
|false == 0|true|
|true == 1|true|
|true == 2|false|
|undefined == 0|false|
|null == 0|false|
|"5" == 5|true|

#### 2、全等和不全等

和上面的区别就是在比较之前不会转换操作数，全等由三个等号表示（===），不全等为（！==）。

例：
```js
var result1 = ("55" == 55); //true，因为转换后相等
var result2 = ("55" === 55); //false，因为不同的数据类型不相等
```

<b>注：null == undefined 会返回 true，因为它们是类似的值；但 null === undefined 会返回 false，因为它们是不同类型的值。</b>

## 条件操作符

```js
var max = (num1 > num2) ? num1 : num2;
```
含义：如果 num1 大于 num2（关系表达式返回 true），则将 num1 的值赋给 max；如果 num1 小于或等于 num2（关系表达式返回 false），则将 num2 的值赋给 max。这个式子整体也叫做三元一次表达式。

## 赋值操作符

由等于号（=）表示，其作用就是把右侧的值赋给左侧的变量。

复合赋值：
```js
一般写法：
var num = 10; 
num = num + 10;

可以简写成：
var num = 10; 
num += 10;
```
还有一些其他的复合赋值操作符：
- 乘/赋值（*=）；
- 除/赋值（/=）；
- 模/赋值（%=）；
- 加/赋值（+=）；
- 减/赋值（-=）；
- 左移/赋值（<<=）；
- 有符号右移/赋值（>>=）；
- 无符号右移/赋值（>>>=）。

设计这些操作符的主要目的就是<b>简化赋值操作</b>。使用它们不会带来任何性能的提升。

## 逗号操作符

使用逗号操作符可以在一条语句中执行多个操作：

- 声明多个变量
  ```js
  var num1 = 1, num2 = 2, num3 = 3;
  ```
- 赋值时取最后一项
  ```js
  var num = (5, 1, 4, 8, 0); // num 的值为 0
  ```
